#teradata_query="""SELECT DISTINCT sum(1) over( rows unbounded preceding ) as  ROW_ID,   TRIM(R.RFRNC_NBR) AS  RFRNC_NBR, TRIM(S.SRVC_LINE_NBR) AS SRVC_LINE_NBR, TRIM(R.CLNCL_SOR_CD) AS CLNCL_SOR_CD, TRIM(R.MBRSHP_SOR_CD) AS MBRSHP_SOR_CD, TRIM(STTS.UM_SRVC_STTS_CD) AS UM_SRVC_STTS_CD, TRIM(STTS.SRC_UM_SRVC_STTS_CD) AS SRC_UM_SRVC_STTS_CD, TRIM(R.SRC_SBSCRBR_ID) AS SRC_SBSCRBR_ID, TRIM(R.SRC_MBR_CD) AS SRC_MBR_CD, TRIM(R.PRMRY_DIAG_CD) AS PRMRY_DIAG_CD, TRIM(S.RQSTD_PLACE_OF_SRVC_CD) AS RQSTD_PLACE_OF_SRVC_CD, TRIM(S.SRC_RQSTD_PLACE_OF_SRVC_CD) AS SRC_RQSTD_PLACE_OF_SRVC_CD, TRIM(S.AUTHRZD_PLACE_OF_SRVC_CD) AS AUTHRZD_PLACE_OF_SRVC_CD, TRIM(S.SRC_AUTHRZD_PLACE_OF_SRVC_CD) AS SRC_AUTHRZD_PLACE_OF_SRVC_CD, TRIM(S.RQSTD_SRVC_FROM_DT) AS RQSTD_SRVC_FROM_DT, TRIM(S.AUTHRZD_SRVC_FROM_DT) AS AUTHRZD_SRVC_FROM_DT, TRIM(S.RQSTD_SRVC_TO_DT) AS RQSTD_SRVC_TO_DT, TRIM(S.AUTHRZD_SRVC_TO_DT) AS AUTHRZD_SRVC_TO_DT, TRIM(S.RQSTD_PROC_SRVC_CD) AS RQSTD_PROC_SRVC_CD, TRIM(S.AUTHRZD_PROC_SRVC_CD) AS AUTHRZD_PROC_SRVC_CD, TRIM(S.RQSTD_QTY) AS RQSTD_QTY, TRIM(S.AUTHRZD_QTY) AS AUTHRZD_QTY, TRIM(SP.SRC_UM_PROV_ID) AS SRC_UM_PROV_ID, TRIM(SP.PROV_ID) AS PROV_ID, TRIM(RP.SRC_UM_PROV_ID) AS SRC_UM_PROV_ID_RP, TRIM(RP.PROV_ID) AS PROV_ID_RP, TRIM(RP.SRC_PROV_FRST_NM) AS SRC_PROV_FRST_NM_RP, TRIM(RP.SRC_PROV_LAST_NM) AS SRC_PROV_LAST_NM_RP, TRIM(SP.SRC_PROV_FRST_NM) AS SRC_PROV_FRST_NM, TRIM(SP.SRC_PROV_LAST_NM) AS SRC_PROV_LAST_NM FROM T89_ETL_VIEWS_ENT.UM_RQST R INNER JOIN T89_ETL_VIEWS_ENT.UM_SRVC S ON  R.RFRNC_NBR = S.RFRNC_NBR   AND R.CLNCL_SOR_CD = S.CLNCL_SOR_CD and R.CLNCL_SOR_CD like '11%' LEFT JOIN T89_ETL_VIEWS_ENT.UM_RQST_PROV RP ON R.RFRNC_NBR = RP.RFRNC_NBR  AND R.CLNCL_SOR_CD = RP.CLNCL_SOR_CD LEFT JOIN T89_ETL_VIEWS_ENT.UM_SRVC_PROV SP ON R.RFRNC_NBR = SP.RFRNC_NBR AND S.SRVC_LINE_NBR = SP.SRVC_LINE_NBR  AND R.CLNCL_SOR_CD = SP.CLNCL_SOR_CD  AND S.CLNCL_SOR_CD = SP.CLNCL_SOR_CD LEFT JOIN T89_ETL_VIEWS_ENT.UM_SRVC_STTS STTS ON R.RFRNC_NBR = STTS.RFRNC_NBR AND S.SRVC_LINE_NBR = STTS.SRVC_LINE_NBR AND R.CLNCL_SOR_CD = STTS.CLNCL_SOR_CD AND S.CLNCL_SOR_CD = STTS.CLNCL_SOR_CD WHERE R.MBRSHP_SOR_CD in ('808', '815') SAMPLE 1000"""

# Total Original - with row number and need partition
#teradata_query=SELECT DISTINCT sum(1) over( rows unbounded preceding ) as  ROW_ID,   TRIM(R.RFRNC_NBR) AS  RFRNC_NBR, TRIM(S.SRVC_LINE_NBR) AS SRVC_LINE_NBR, TRIM(R.CLNCL_SOR_CD) AS CLNCL_SOR_CD, TRIM(R.MBRSHP_SOR_CD) AS MBRSHP_SOR_CD, TRIM(STTS.UM_SRVC_STTS_CD) AS UM_SRVC_STTS_CD, TRIM(STTS.SRC_UM_SRVC_STTS_CD) AS SRC_UM_SRVC_STTS_CD, TRIM(R.SRC_SBSCRBR_ID) AS SRC_SBSCRBR_ID, TRIM(R.SRC_MBR_CD) AS SRC_MBR_CD, TRIM(R.PRMRY_DIAG_CD) AS PRMRY_DIAG_CD, TRIM(S.RQSTD_PLACE_OF_SRVC_CD) AS RQSTD_PLACE_OF_SRVC_CD, TRIM(S.SRC_RQSTD_PLACE_OF_SRVC_CD) AS SRC_RQSTD_PLACE_OF_SRVC_CD, TRIM(S.AUTHRZD_PLACE_OF_SRVC_CD) AS AUTHRZD_PLACE_OF_SRVC_CD, TRIM(S.SRC_AUTHRZD_PLACE_OF_SRVC_CD) AS SRC_AUTHRZD_PLACE_OF_SRVC_CD, TRIM(S.RQSTD_SRVC_FROM_DT) AS RQSTD_SRVC_FROM_DT, TRIM(S.AUTHRZD_SRVC_FROM_DT) AS AUTHRZD_SRVC_FROM_DT, TRIM(S.RQSTD_SRVC_TO_DT) AS RQSTD_SRVC_TO_DT, TRIM(S.AUTHRZD_SRVC_TO_DT) AS AUTHRZD_SRVC_TO_DT, TRIM(S.RQSTD_PROC_SRVC_CD) AS RQSTD_PROC_SRVC_CD, TRIM(S.AUTHRZD_PROC_SRVC_CD) AS AUTHRZD_PROC_SRVC_CD, TRIM(S.RQSTD_QTY) AS RQSTD_QTY, TRIM(S.AUTHRZD_QTY) AS AUTHRZD_QTY, TRIM(SP.SRC_UM_PROV_ID) AS SRC_UM_PROV_ID, TRIM(SP.PROV_ID) AS PROV_ID, TRIM(RP.SRC_UM_PROV_ID) AS SRC_UM_PROV_ID_RP, TRIM(RP.PROV_ID) AS PROV_ID_RP, TRIM(RP.SRC_PROV_FRST_NM) AS SRC_PROV_FRST_NM_RP, TRIM(RP.SRC_PROV_LAST_NM) AS SRC_PROV_LAST_NM_RP, TRIM(SP.SRC_PROV_FRST_NM) AS SRC_PROV_FRST_NM, TRIM(SP.SRC_PROV_LAST_NM) AS SRC_PROV_LAST_NM FROM T89_ETL_VIEWS_ENT_XM.UM_RQST R INNER JOIN T89_ETL_VIEWS_ENT_XM.UM_SRVC S ON  R.RFRNC_NBR = S.RFRNC_NBR   AND R.CLNCL_SOR_CD = S.CLNCL_SOR_CD and R.CLNCL_SOR_CD like '11%' LEFT JOIN T89_ETL_VIEWS_ENT_XM.UM_RQST_PROV RP ON R.RFRNC_NBR = RP.RFRNC_NBR  AND R.CLNCL_SOR_CD = RP.CLNCL_SOR_CD LEFT JOIN T89_ETL_VIEWS_ENT_XM.UM_SRVC_PROV SP ON R.RFRNC_NBR = SP.RFRNC_NBR AND S.SRVC_LINE_NBR = SP.SRVC_LINE_NBR  AND R.CLNCL_SOR_CD = SP.CLNCL_SOR_CD  AND S.CLNCL_SOR_CD = SP.CLNCL_SOR_CD LEFT JOIN T89_ETL_VIEWS_ENT_XM.UM_SRVC_STTS STTS ON R.RFRNC_NBR = STTS.RFRNC_NBR AND S.SRVC_LINE_NBR = STTS.SRVC_LINE_NBR AND R.CLNCL_SOR_CD = STTS.CLNCL_SOR_CD AND S.CLNCL_SOR_CD = STTS.CLNCL_SOR_CD WHERE R.MBRSHP_SOR_CD in ('808', '815') SAMPLE 100

# Total Without Row ID
#teradata_query=SELECT  DISTINCT TRIM(R.RFRNC_NBR) AS  RFRNC_NBR, TRIM(S.SRVC_LINE_NBR) AS SRVC_LINE_NBR, TRIM(R.CLNCL_SOR_CD) AS CLNCL_SOR_CD, TRIM(R.MBRSHP_SOR_CD) AS MBRSHP_SOR_CD, TRIM(STTS.UM_SRVC_STTS_CD) AS UM_SRVC_STTS_CD, TRIM(STTS.SRC_UM_SRVC_STTS_CD) AS SRC_UM_SRVC_STTS_CD, TRIM(R.SRC_SBSCRBR_ID) AS SRC_SBSCRBR_ID, TRIM(R.SRC_MBR_CD) AS SRC_MBR_CD, TRIM(R.PRMRY_DIAG_CD) AS PRMRY_DIAG_CD, TRIM(S.RQSTD_PLACE_OF_SRVC_CD) AS RQSTD_PLACE_OF_SRVC_CD, TRIM(S.SRC_RQSTD_PLACE_OF_SRVC_CD) AS SRC_RQSTD_PLACE_OF_SRVC_CD, TRIM(S.AUTHRZD_PLACE_OF_SRVC_CD) AS AUTHRZD_PLACE_OF_SRVC_CD, TRIM(S.SRC_AUTHRZD_PLACE_OF_SRVC_CD) AS SRC_AUTHRZD_PLACE_OF_SRVC_CD, TRIM(S.RQSTD_SRVC_FROM_DT) AS RQSTD_SRVC_FROM_DT, TRIM(S.AUTHRZD_SRVC_FROM_DT) AS AUTHRZD_SRVC_FROM_DT, TRIM(S.RQSTD_SRVC_TO_DT) AS RQSTD_SRVC_TO_DT, TRIM(S.AUTHRZD_SRVC_TO_DT) AS AUTHRZD_SRVC_TO_DT, TRIM(S.RQSTD_PROC_SRVC_CD) AS RQSTD_PROC_SRVC_CD, TRIM(S.AUTHRZD_PROC_SRVC_CD) AS AUTHRZD_PROC_SRVC_CD, TRIM(S.RQSTD_QTY) AS RQSTD_QTY, TRIM(S.AUTHRZD_QTY) AS AUTHRZD_QTY, TRIM(SP.SRC_UM_PROV_ID) AS SRC_UM_PROV_ID, TRIM(SP.PROV_ID) AS PROV_ID, TRIM(RP.SRC_UM_PROV_ID) AS SRC_UM_PROV_ID_RP, TRIM(RP.PROV_ID) AS PROV_ID_RP, TRIM(RP.SRC_PROV_FRST_NM) AS SRC_PROV_FRST_NM_RP, TRIM(RP.SRC_PROV_LAST_NM) AS SRC_PROV_LAST_NM_RP, TRIM(SP.SRC_PROV_FRST_NM) AS SRC_PROV_FRST_NM, TRIM(SP.SRC_PROV_LAST_NM) AS SRC_PROV_LAST_NM FROM T89_ETL_VIEWS_ENT_XM.UM_RQST R INNER JOIN T89_ETL_VIEWS_ENT_XM.UM_SRVC S ON  R.RFRNC_NBR = S.RFRNC_NBR   AND R.CLNCL_SOR_CD = S.CLNCL_SOR_CD and R.CLNCL_SOR_CD like '11%' LEFT JOIN T89_ETL_VIEWS_ENT_XM.UM_RQST_PROV RP ON R.RFRNC_NBR = RP.RFRNC_NBR  AND R.CLNCL_SOR_CD = RP.CLNCL_SOR_CD LEFT JOIN T89_ETL_VIEWS_ENT_XM.UM_SRVC_PROV SP ON R.RFRNC_NBR = SP.RFRNC_NBR AND S.SRVC_LINE_NBR = SP.SRVC_LINE_NBR  AND R.CLNCL_SOR_CD = SP.CLNCL_SOR_CD  AND S.CLNCL_SOR_CD = SP.CLNCL_SOR_CD LEFT JOIN T89_ETL_VIEWS_ENT_XM.UM_SRVC_STTS STTS ON R.RFRNC_NBR = STTS.RFRNC_NBR AND S.SRVC_LINE_NBR = STTS.SRVC_LINE_NBR AND R.CLNCL_SOR_CD = STTS.CLNCL_SOR_CD AND S.CLNCL_SOR_CD = STTS.CLNCL_SOR_CD WHERE R.MBRSHP_SOR_CD in ('808', '815') SAMPLE 100

#Incremental
#teradata_query=SELECT DISTINCT sum(1) over( rows unbounded preceding ) as  ROW_ID,   TRIM(R.RFRNC_NBR) AS  RFRNC_NBR, TRIM(S.SRVC_LINE_NBR) AS SRVC_LINE_NBR, TRIM(R.CLNCL_SOR_CD) AS CLNCL_SOR_CD, TRIM(R.MBRSHP_SOR_CD) AS MBRSHP_SOR_CD, TRIM(STTS.UM_SRVC_STTS_CD) AS UM_SRVC_STTS_CD, TRIM(STTS.SRC_UM_SRVC_STTS_CD) AS SRC_UM_SRVC_STTS_CD, TRIM(R.SRC_SBSCRBR_ID) AS SRC_SBSCRBR_ID, TRIM(R.SRC_MBR_CD) AS SRC_MBR_CD, TRIM(R.PRMRY_DIAG_CD) AS PRMRY_DIAG_CD, TRIM(S.RQSTD_PLACE_OF_SRVC_CD) AS RQSTD_PLACE_OF_SRVC_CD, TRIM(S.SRC_RQSTD_PLACE_OF_SRVC_CD) AS SRC_RQSTD_PLACE_OF_SRVC_CD, TRIM(S.AUTHRZD_PLACE_OF_SRVC_CD) AS AUTHRZD_PLACE_OF_SRVC_CD, TRIM(S.SRC_AUTHRZD_PLACE_OF_SRVC_CD) AS SRC_AUTHRZD_PLACE_OF_SRVC_CD, TRIM(S.RQSTD_SRVC_FROM_DT) AS RQSTD_SRVC_FROM_DT, TRIM(S.AUTHRZD_SRVC_FROM_DT) AS AUTHRZD_SRVC_FROM_DT, TRIM(S.RQSTD_SRVC_TO_DT) AS RQSTD_SRVC_TO_DT, TRIM(S.AUTHRZD_SRVC_TO_DT) AS AUTHRZD_SRVC_TO_DT, TRIM(S.RQSTD_PROC_SRVC_CD) AS RQSTD_PROC_SRVC_CD, TRIM(S.AUTHRZD_PROC_SRVC_CD) AS AUTHRZD_PROC_SRVC_CD, TRIM(S.RQSTD_QTY) AS RQSTD_QTY, TRIM(S.AUTHRZD_QTY) AS AUTHRZD_QTY, TRIM(SP.SRC_UM_PROV_ID) AS SRC_UM_PROV_ID, TRIM(SP.PROV_ID) AS PROV_ID, TRIM(RP.SRC_UM_PROV_ID) AS SRC_UM_PROV_ID_RP, TRIM(RP.PROV_ID) AS PROV_ID_RP, TRIM(RP.SRC_PROV_FRST_NM) AS SRC_PROV_FRST_NM_RP, TRIM(RP.SRC_PROV_LAST_NM) AS SRC_PROV_LAST_NM_RP, TRIM(SP.SRC_PROV_FRST_NM) AS SRC_PROV_FRST_NM, TRIM(SP.SRC_PROV_LAST_NM) AS SRC_PROV_LAST_NM FROM T89_ETL_VIEWS_ENT_XM.UM_RQST R inner join (select distinct SRC_SBSCRBR_ID from T89_ETL_VIEWS_ENT_XM.um_rqst  where MBRSHP_SOR_CD in ('808', '815','886', '823')  and length(trim(SRC_SBSCRBR_ID))=9 and RCRD_STTS_CD<> 'DUP' and updtd_load_log_key in (select load_log_key from  T89_ETL_VIEWS_ENT_XM.edw_load_log where  cast(pblsh_dtm as date format 'yyyymmdd') >= '<<load_date>>'  and work_flow_nm ='CLINICAL_EDW_LOAD' and pblsh_ind='Y') or crctd_load_log_key in (select  load_log_key from  T89_ETL_VIEWS_ENT_XM.edw_load_log where  cast(pblsh_dtm as date format 'yyyymmdd') >= '<<load_date>>'  and work_flow_nm ='CLINICAL_EDW_LOAD'   and pblsh_ind='Y')) a on a.SRC_SBSCRBR_ID=R.SRC_SBSCRBR_ID INNER JOIN T89_ETL_VIEWS_ENT_XM.UM_SRVC S ON  R.RFRNC_NBR = S.RFRNC_NBR   AND R.CLNCL_SOR_CD = S.CLNCL_SOR_CD LEFT JOIN T89_ETL_VIEWS_ENT_XM.UM_RQST_PROV RP ON R.RFRNC_NBR = RP.RFRNC_NBR  AND R.CLNCL_SOR_CD = RP.CLNCL_SOR_CD LEFT JOIN T89_ETL_VIEWS_ENT_XM.UM_SRVC_PROV SP ON R.RFRNC_NBR = SP.RFRNC_NBR AND S.SRVC_LINE_NBR = SP.SRVC_LINE_NBR  AND R.CLNCL_SOR_CD = SP.CLNCL_SOR_CD  AND S.CLNCL_SOR_CD = SP.CLNCL_SOR_CD LEFT JOIN T89_ETL_VIEWS_ENT_XM.UM_SRVC_STTS STTS ON R.RFRNC_NBR = STTS.RFRNC_NBR AND S.SRVC_LINE_NBR = STTS.SRVC_LINE_NBR AND R.CLNCL_SOR_CD = STTS.CLNCL_SOR_CD AND S.CLNCL_SOR_CD = STTS.CLNCL_SOR_CD WHERE R.MBRSHP_SOR_CD in ('808', '815','886', '823') and LENGTH(TRIM(R.SRC_SBSCRBR_ID))=9 and  R.RCRD_STTS_CD<> 'DUP' GROUP BY r.RFRNC_NBR, s.SRVC_LINE_NBR, r.CLNCL_SOR_CD, r.MBRSHP_SOR_CD, stts.UM_SRVC_STTS_CD, stts.SRC_UM_SRVC_STTS_CD, r.src_sbscrbr_id, r.src_mbr_cd, r.prmry_diag_cd, s.RQSTD_PLACE_OF_SRVC_CD, s.SRC_RQSTD_PLACE_OF_SRVC_CD, s.AUTHRZD_PLACE_OF_SRVC_CD, s.SRC_AUTHRZD_PLACE_OF_SRVC_CD, s.RQSTD_SRVC_FROM_DT, s.AUTHRZD_SRVC_FROM_DT, s.RQSTD_SRVC_TO_DT, s.AUTHRZD_SRVC_TO_DT, s.RQSTD_PROC_SRVC_CD, s.AUTHRZD_PROC_SRVC_CD, s.RQSTD_QTY, s.AUTHRZD_QTY, sp.src_um_prov_id, sp.prov_id, rp.src_um_prov_id, rp.prov_id, rp.SRC_PROV_FRST_NM, rp.SRC_PROV_LAST_NM, sp.SRC_PROV_FRST_NM, sp.SRC_PROV_LAST_NM

#Incremental without row number
teradata_query= select DISTINCT TRIM(R.RFRNC_NBR) AS  RFRNC_NBR, TRIM(S.SRVC_LINE_NBR) AS SRVC_LINE_NBR, TRIM(R.CLNCL_SOR_CD) AS CLNCL_SOR_CD, TRIM(R.MBRSHP_SOR_CD) AS MBRSHP_SOR_CD, TRIM(STTS.UM_SRVC_STTS_CD) AS UM_SRVC_STTS_CD, TRIM(STTS.SRC_UM_SRVC_STTS_CD) AS SRC_UM_SRVC_STTS_CD, TRIM(R.SRC_SBSCRBR_ID) AS SRC_SBSCRBR_ID, TRIM(R.SRC_MBR_CD) AS SRC_MBR_CD, TRIM(R.PRMRY_DIAG_CD) AS PRMRY_DIAG_CD, TRIM(S.RQSTD_PLACE_OF_SRVC_CD) AS RQSTD_PLACE_OF_SRVC_CD, TRIM(S.SRC_RQSTD_PLACE_OF_SRVC_CD) AS SRC_RQSTD_PLACE_OF_SRVC_CD, TRIM(S.AUTHRZD_PLACE_OF_SRVC_CD) AS AUTHRZD_PLACE_OF_SRVC_CD, TRIM(S.SRC_AUTHRZD_PLACE_OF_SRVC_CD) AS SRC_AUTHRZD_PLACE_OF_SRVC_CD, TRIM(S.RQSTD_SRVC_FROM_DT) AS RQSTD_SRVC_FROM_DT, TRIM(S.AUTHRZD_SRVC_FROM_DT) AS AUTHRZD_SRVC_FROM_DT, TRIM(S.RQSTD_SRVC_TO_DT) AS RQSTD_SRVC_TO_DT, TRIM(S.AUTHRZD_SRVC_TO_DT) AS AUTHRZD_SRVC_TO_DT, TRIM(S.RQSTD_PROC_SRVC_CD) AS RQSTD_PROC_SRVC_CD, TRIM(S.AUTHRZD_PROC_SRVC_CD) AS AUTHRZD_PROC_SRVC_CD, TRIM(S.RQSTD_QTY) AS RQSTD_QTY, TRIM(S.AUTHRZD_QTY) AS AUTHRZD_QTY, TRIM(SP.SRC_UM_PROV_ID) AS SRC_UM_PROV_ID, TRIM(SP.PROV_ID) AS PROV_ID, TRIM(RP.SRC_UM_PROV_ID) AS SRC_UM_PROV_ID_RP, TRIM(RP.PROV_ID) AS PROV_ID_RP, TRIM(RP.SRC_PROV_FRST_NM) AS SRC_PROV_FRST_NM_RP, TRIM(RP.SRC_PROV_LAST_NM) AS SRC_PROV_LAST_NM_RP, TRIM(SP.SRC_PROV_FRST_NM) AS SRC_PROV_FRST_NM, TRIM(SP.SRC_PROV_LAST_NM) AS SRC_PROV_LAST_NM FROM T89_ETL_VIEWS_ENT_XM.UM_RQST R inner join (select distinct SRC_SBSCRBR_ID from T89_ETL_VIEWS_ENT_XM.um_rqst  where MBRSHP_SOR_CD in ('808', '815','886', '823')  and length(trim(SRC_SBSCRBR_ID))=9 and RCRD_STTS_CD<> 'DUP' and updtd_load_log_key in (select load_log_key from  T89_ETL_VIEWS_ENT_XM.edw_load_log where  cast(pblsh_dtm as date format 'yyyymmdd') >= '<<load_date>>'  and work_flow_nm ='CLINICAL_EDW_LOAD' and pblsh_ind='Y') or crctd_load_log_key in (select  load_log_key from  T89_ETL_VIEWS_ENT_XM.edw_load_log where  cast(pblsh_dtm as date format 'yyyymmdd') >= '<<load_date>>'  and work_flow_nm ='CLINICAL_EDW_LOAD'   and pblsh_ind='Y')) a on a.SRC_SBSCRBR_ID=R.SRC_SBSCRBR_ID INNER JOIN T89_ETL_VIEWS_ENT_XM.UM_SRVC S ON  R.RFRNC_NBR = S.RFRNC_NBR   AND R.CLNCL_SOR_CD = S.CLNCL_SOR_CD LEFT JOIN T89_ETL_VIEWS_ENT_XM.UM_RQST_PROV RP ON R.RFRNC_NBR = RP.RFRNC_NBR  AND R.CLNCL_SOR_CD = RP.CLNCL_SOR_CD LEFT JOIN T89_ETL_VIEWS_ENT_XM.UM_SRVC_PROV SP ON R.RFRNC_NBR = SP.RFRNC_NBR AND S.SRVC_LINE_NBR = SP.SRVC_LINE_NBR  AND R.CLNCL_SOR_CD = SP.CLNCL_SOR_CD  AND S.CLNCL_SOR_CD = SP.CLNCL_SOR_CD LEFT JOIN T89_ETL_VIEWS_ENT_XM.UM_SRVC_STTS STTS ON R.RFRNC_NBR = STTS.RFRNC_NBR AND S.SRVC_LINE_NBR = STTS.SRVC_LINE_NBR AND R.CLNCL_SOR_CD = STTS.CLNCL_SOR_CD AND S.CLNCL_SOR_CD = STTS.CLNCL_SOR_CD WHERE R.MBRSHP_SOR_CD in ('808', '815','886', '823') and LENGTH(TRIM(R.SRC_SBSCRBR_ID))=9 and  R.RCRD_STTS_CD<> 'DUP' sample 100

#select  r.RFRNC_NBR, s.SRVC_LINE_NBR, r.CLNCL_SOR_CD, r.MBRSHP_SOR_CD, stts.UM_SRVC_STTS_CD, stts.SRC_UM_SRVC_STTS_CD, r.src_sbscrbr_id, r.src_mbr_cd, r.prmry_diag_cd, s.RQSTD_PLACE_OF_SRVC_CD, s.SRC_RQSTD_PLACE_OF_SRVC_CD, s.AUTHRZD_PLACE_OF_SRVC_CD, s.SRC_AUTHRZD_PLACE_OF_SRVC_CD, s.RQSTD_SRVC_FROM_DT, s.AUTHRZD_SRVC_FROM_DT, s.RQSTD_SRVC_TO_DT, s.AUTHRZD_SRVC_TO_DT, s.RQSTD_PROC_SRVC_CD, s.AUTHRZD_PROC_SRVC_CD, s.RQSTD_QTY, s.AUTHRZD_QTY, sp.src_um_prov_id, sp.prov_id, rp.src_um_prov_id  as src_um_prov_id_rp, rp.prov_id as prov_id_rp , rp.SRC_PROV_FRST_NM as SRC_PROV_FRST_NM_RP , rp.SRC_PROV_LAST_NM  as SRC_PROV_LAST_NM_RP, sp.SRC_PROV_FRST_NM, sp.SRC_PROV_LAST_NM from T89_ETL_VIEWS_ENT_XM.um_rqst r inner join (select distinct SRC_SBSCRBR_ID from T89_ETL_VIEWS_ENT_XM.um_rqst  where MBRSHP_SOR_CD in ('808', '815','886', '823')  and length(trim(SRC_SBSCRBR_ID))=9 and RCRD_STTS_CD<> 'DUP' and updtd_load_log_key in (select load_log_key from  T89_ETL_VIEWS_ENT_XM.edw_load_log where  cast(pblsh_dtm as date format 'yyyymmdd') >= :date1  and work_flow_nm ='CLINICAL_EDW_LOAD' and pblsh_ind='Y') or crctd_load_log_key in (select  load_log_key from  T89_ETL_VIEWS_ENT_XM.edw_load_log where  cast(pblsh_dtm as date format 'yyyymmdd') >= :date1  and work_flow_nm ='CLINICAL_EDW_LOAD'   and pblsh_ind='Y')) a on a.SRC_SBSCRBR_ID=r.SRC_SBSCRBR_ID inner join T89_ETL_VIEWS_ENT_XM.UM_SRVC s on  r.RFRNC_NBR = s.RFRNC_NBR   and r.CLNCL_SOR_CD = s.CLNCL_SOR_CD left join T89_ETL_VIEWS_ENT_XM.UM_RQST_PROV rp on r.RFRNC_NBR = rp.RFRNC_NBR  and r.CLNCL_SOR_CD = rp.CLNCL_SOR_CD left join T89_ETL_VIEWS_ENT_XM.UM_SRVC_PROV sp on r.RFRNC_NBR = sp.RFRNC_NBR and s.SRVC_LINE_NBR = sp.SRVC_LINE_NBR  and r.CLNCL_SOR_CD = sp.CLNCL_SOR_CD  and s.CLNCL_SOR_CD = sp.CLNCL_SOR_CD left join T89_ETL_VIEWS_ENT_XM.UM_SRVC_STTS stts on r.RFRNC_NBR = stts.RFRNC_NBR and s.SRVC_LINE_NBR = stts.SRVC_LINE_NBR and r.CLNCL_SOR_CD = stts.CLNCL_SOR_CD and s.CLNCL_SOR_CD = stts.CLNCL_SOR_CD where     r.MBRSHP_SOR_CD in ('808', '815','886', '823')  and length(trim(r.SRC_SBSCRBR_ID))=9 and r.RCRD_STTS_CD<> 'DUP' group by r.RFRNC_NBR, s.SRVC_LINE_NBR, r.CLNCL_SOR_CD, r.MBRSHP_SOR_CD, stts.UM_SRVC_STTS_CD, stts.SRC_UM_SRVC_STTS_CD, r.src_sbscrbr_id, r.src_mbr_cd, r.prmry_diag_cd, s.RQSTD_PLACE_OF_SRVC_CD, s.SRC_RQSTD_PLACE_OF_SRVC_CD, s.AUTHRZD_PLACE_OF_SRVC_CD, s.SRC_AUTHRZD_PLACE_OF_SRVC_CD, s.RQSTD_SRVC_FROM_DT, s.AUTHRZD_SRVC_FROM_DT, s.RQSTD_SRVC_TO_DT, s.AUTHRZD_SRVC_TO_DT, s.RQSTD_PROC_SRVC_CD, s.AUTHRZD_PROC_SRVC_CD, s.RQSTD_QTY, s.AUTHRZD_QTY, sp.src_um_prov_id, sp.prov_id, rp.src_um_prov_id, rp.prov_id, rp.SRC_PROV_FRST_NM, rp.SRC_PROV_LAST_NM, sp.SRC_PROV_FRST_NM, sp.SRC_PROV_LAST_NM
cogx_audit_query="select max(CAST(date_format(to_date(lastupdate),'yyyyMMdd') as INT)) from dv_ccpcogxph_nogbd_r000_wh.cogx_um_teradata_hb_audit where program='<<programName>>' and status ='completed' "



teradata_table_name=cogx_um_auth
jdbcdriver= com.teradata.jdbc.TeraDriver
fetch_size=10000
sourceType=Teradata
sourceDesc=COGx UM data sourced from EDWard
hbase_table_name=cogx_benefits
hbase_table_columnfamily=um
#C1 
hbase_table_columnname=jsonData
auditTable=pinnga1ph_dv_r2a_wh.pgm_intrgty_load_log_hbase
historicalLoad=false

### remove quote to run on Local
hbaseconfigfile=hbase-site.xml

#
audit-column-name=last_updt_dtm

isIncremental=yes
default_incremental_startdt=20190401
force_default_incremental=Yes

#
ABCSaveFormat=none
#ABCLocalOutputPathFile=C:\\java\\git\\repos\\coe_2.0\\target\\ABCAudit.csv
#saveDataFramePath=C:\\java\\git\\repos\\cognitiveclaim_dev\\ds-cogx-etl-padp\\ds-cogx-etl-padp\\data\\SavedDataFrame
