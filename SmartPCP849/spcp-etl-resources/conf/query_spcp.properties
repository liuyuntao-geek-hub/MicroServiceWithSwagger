#SPCP-ETL audit columns
spcp-etl-audit-table=ETL_AUDIT
audit-column-name=last_updt_dtm

#TARGET TABLES
memberTargetTable=MBR_INFO
providerTargetTable=PROVIDER_INFO
pcpGeocodeTargetTable=PCP_GEOCODES
pcpGeocodeRefAdrsTable=REF_ADRS
vbpTargetTable=WGSP_PCP_VBP_MAPPING
ProdPkgTargetTable=PROD_PKG
ProdPlanTargetTable=PROD_PLAN

#PCP_GEOCODES
query_wgsp_pcp_adrs="select trim(hmo_type_cd) AS hmo_type_cd, trim(src_sor_cd) as src_sor_cd, trim(pcp_efctv_dt) AS pcp_efctv_dt, trim(adrs_cnty_cd) AS adrs_cnty_cd, trim(adrs_typ_cd) AS adrs_typ_cd, trim(adrs_id) AS adrs_id, trim(adrs_efctv_dt) AS adrs_efctv_dt, trim(prov_pcp_id) AS prov_pcp_id, trim(adrs_st_cd) AS adrs_st_cd,trim(adrs_zip_cd) AS adrs_zip_cd, trim(adrs_zip_plus_4_cd) AS adrs_zip_plus_4_cd,trim(adrs_line_1_txt) AS adrs_line_1_txt,trim(adrs_line_2_txt) AS adrs_line_2_txt, trim(adrs_city_nm) AS adrs_city_nm,trim(adrs_cnty_nm) AS adrs_cnty_nm,trim(pa_cmnctn_typ_value) AS pa_cmnctn_typ_value from <spcp-splice-db>.WGSP_PCP_ADRS"
query_ref_adrs="select adrs_line_1_txt, adrs_line_2_txt, adrs_city_nm, adrs_st_cd, adrs_zip_cd, latd_cordnt_nbr, lngtd_cordnt_nbr from <spcp-splice-db>.ref_adrs"


#MEMBER DENORMALISATION
query_mem_prod_enrolmnt="select distinct trim(mbr_key) as mbr_key, trim(hc_id) as hc_id from ts_cdledwd_allphi_xm.mbr_prod_enrlmnt where trim(rcrd_stts_cd) = 'ACT' and trim(vrsn_clos_dt) = '8888-12-31'"
query_mem="select trim(mbr_key) as mbr_key, frst_nm,last_nm,MID_INIT_NM, brth_dt,trim(leading '0' from MBR_SQNC_NBR) as MBR_SQNC_NBR from ts_cdledwd_allphi_xm.mbr where trim(rcrd_stts_cd) = 'ACT' and trim(vrsn_clos_dt) = '8888-12-31'"
query_xwalk="select mcid, trim(mbr_key) as mbr_key from ts_cdlpims_allphi_xm..pi_mcid_mbr_key_xwalk_all"
query_wgsp_pcp="select trim(hmo_type_cd) as hmo_type_cd,trim(src_sor_cd) as src_sor_cd,pcp_efctv_dt,trim(tax_id) as tax_id, trim(prov_pcp_id) as prov_pcp_id from ts_cdlwgsp_allphi_xm.wgsp_pcp"
query_wgsp_pcp_altid_mbr="select trim(hmo_type_cd) as hmo_type_cd,trim(src_sor_cd) as src_sor_cd,pcp_efctv_dt,trim(npi) as npi, trim(prov_pcp_id) as prov_pcp_id from ts_cdlwgsp_allphi_xm.wgsp_pcp_altid where length(trim(npi))=10 and prov_altid_trmntn_dt > current_date and trim(prov_altid_type_cd) in ('45','05')"
query_pi_afnty_atrbn="select a.* from (select trim(prov_org_tax_id) as prov_org_tax_id,trim(ip_npi) as ip_npi,rankg_ordr_nbr,trim(afnty_file_type_cd) as afnty_file_type_cd,mcid,sor_dtm from ts_cdlpims_allphi_xm.pi_afnty_atrbn where trim(rcrd_stts_cd) = 'ACT' and vrsn_clos_dt = '8888-12-31' and trim(afnty_file_type_cd) = 'DFLT') a inner join (select trim(prov_org_tax_id) as prov_org_tax_id,trim(ip_npi) as ip_npi,mcid,max(sor_dtm) as max_sor_dtm from ts_cdlpims_allphi_xm.pi_afnty_atrbn where trim(rcrd_stts_cd) = 'ACT' and vrsn_clos_dt = '8888-12-31' and trim(afnty_file_type_cd) = 'DFLT' group by prov_org_tax_id,ip_npi,mcid) b on a.prov_org_tax_id = b.prov_org_tax_id and a.ip_npi = b.ip_npi and a.mcid = b.mcid and a.sor_dtm = b.max_sor_dtm"


#PROVIDER DENORMALISATION
query_wgsp_pcp="select trim(PROV_PCP_ID) as PROV_PCP_ID, trim(SRC_SOR_CD) as SRC_SOR_CD, trim(HMO_TYPE_CD ) as HMO_TYPE_CD, PCP_EFCTV_DT ,trim(PCP_RANKG_ID ) as PCP_RANKG_ID, trim(PCP_FRST_NM) as PCP_FRST_NM, trim(PCP_MID_NM) as PCP_MID_NM, trim(PCP_LAST_NM) as PCP_LAST_NM, trim(PROV_PRTY_CD) as PROV_PRTY_CD, trim(TAX_ID) as TAX_ID  from <spcp-splice-db>.WGSP_PCP"
query_wgsp_pcp_cntrct="select trim(PROV_PCP_ID) as PROV_PCP_ID, trim(LEGCY_NTWK_ID) as LEGCY_NTWK_ID, GRPG_RLTD_PADRS_EFCTV_DT, GRPG_RLTD_PADRS_TRMNTN_DT, MAX_MBR_CNT , CURNT_MBR_CNT, trim(HMO_TYPE_CD) as HMO_TYPE_CD ,trim(SRC_SOR_CD) as SRC_SOR_CD, trim(PCP_EFCTV_DT) as PCP_EFCTV_DT ,trim(RGNL_NTWK_ID) as RGNL_NTWK_ID, trim(CP_TYPE_CD) as CP_TYPE_CD   from <spcp-splice-db>.WGSP_PCP_CNTRCT where GRPG_RLTD_PADRS_TRMNTN_DT>CURRENT_DATE"
query_wgsp_pcp_altid="select trim(PROV_PCP_ID) as PROV_PCP_ID, trim(NPI ) as NPI , trim(SRC_SOR_CD) as SRC_SOR_CD,trim(HMO_TYPE_CD ) as HMO_TYPE_CD , PCP_EFCTV_DT  from <spcp-splice-db>.WGSP_PCP_ALTID where length(trim(NPI))=10 and PROV_ALTID_TRMNTN_DT>CURRENT_DATE AND PROV_ALTID_TYPE_CD in ('45', '05')"
query_wgsp_pcp_prov_lang="select trim(PROV_PCP_ID) as PROV_PCP_ID, trim(SRC_SOR_CD) as SRC_SOR_CD, trim(HMO_TYPE_CD ) as HMO_TYPE_CD, PCP_EFCTV_DT, trim(WGS_LANG_CD) as  WGS_LANG_CD, trim(IP_LANG_CD) as IP_LANG_CD  from <spcp-splice-db>.WGSP_PCP_PROV_LANG"
query_wgs_spcp_lang_mapping="select trim(WGS_LANG_CD) as WGS_LANG_CD, trim(ENT_LANG_CD) as ENT_LANG_CD, trim(ISO_3_CD) as ISO_3_CD, trim(PCP_LANGUAGE) as PCP_LANGUAGE from <spcp-splice-db>.WGSP_PCP_LANG_MAPPING"
query_wgsp_spclty_cd_mapping="select trim(SPCLTY_CD) as SPCLTY_CD,trim(SPCLTY_DESC) as SPCLTY_DESC, trim(SPCLTY_MNEMONICS) as SPCLTY_MNEMONICS from <spcp-splice-db>.WGSP_PCP_SPCLTY_CD_MAPPING"
query_pcp_geocodes="select  LATD_CORDNT_NBR, LNGTD_CORDNT_NBR, trim(ADRS_LINE_1_TXT ) as ADRS_LINE_1_TXT , trim(ADRS_LINE_2_TXT) as ADRS_LINE_2_TXT,trim(ADRS_CITY_NM) as ADRS_CITY_NM, trim(ADRS_ST_CD ) as ADRS_ST_CD , trim(ADRS_ZIP_CD) as ADRS_ZIP_CD,trim(ADRS_ZIP_PLUS_4_CD) as ADRS_ZIP_PLUS_4_CD, trim(PA_CMNCTN_TYP_VALUE) as PA_CMNCTN_TYP_VALUE, trim(HMO_TYPE_CD) as HMO_TYPE_CD, trim(SRC_SOR_CD) as SRC_SOR_CD,  trim(PCP_EFCTV_DT) as PCP_EFCTV_DT,  trim(ADRS_TYP_CD) as ADRS_TYP_CD, trim(ADRS_ID) as ADRS_ID, trim(ADRS_EFCTV_DT) as ADRS_EFCTV_DT, trim(ADRS_CNTY_CD) as ADRS_CNTY_CD, trim(PROV_PCP_ID) as PROV_PCP_ID from <spcp-splice-db>.PCP_GEOCODES_0629"
query_wgsp_cp_cd_mapping="SELECT trim(CP_TYPE_CD) as CP_TYPE_CD, trim(ACC_NEW_PATIENT_FLAG) as ACC_NEW_PATIENT_FLAG FROM <spcp-splice-db>.WGSP_PCP_CP_CD_MAPPING"
vbp_target_table_load_query="SELECT trim(IP_NPI) as IP_NPI, trim(PROV_ORG_TAX_ID) as PROV_ORG_TAX_ID FROM <spcp-splice-db>.WGSP_PCP_VBP_MAPPING"
query_wgsp_pcp_asp="select trim(SPCLTY_CD) as SPCLTY_CD, trim(PROV_PCP_ID) as PROV_PCP_ID, trim(SRC_SOR_CD) as SRC_SOR_CD,trim(HMO_TYPE_CD) as HMO_TYPE_CD, PCP_EFCTV_DT, trim(WGS_SPCLTY_CD) as WGS_SPCLTY_CD, trim(PRMRY_SPCLTY_IND) as PRMRY_SPCLTY_IND, trim(ADRS_TYP_CD) as ADRS_TYP_CD, trim(ADRS_ID) as ADRS_ID, trim(ADRS_EFCTV_DT) as ADRS_EFCTV_DT from <spcp-splice-db>.WGSP_PCP_ASP where PRMRY_SPCLTY_IND='Y'" 
query_hca_pcp_prov_rnkng_mapping="select trim(PROV_ID) as PROV_ID,MDO_RANKING, trim(TAX_ID) as TAX_ID, trim(ADRS_ST_CD) as ADRS_ST_CD, trim(NAME) as NAME from <spcp-splice-db>.WGSP_PCP_HCA_PROV_RNKNG"
query_tierLevel_table_query="select trim(LGCY_NTWK_ID) as LGCY_NTWK_ID, TIER_LEVEL from <spcp-splice-db>.WGSP_PCP_TIER_LVL"

#VBP TABLE CREATION
query_pi_prov_hrchy="select * FROM <spcp-splice-db>.PI_PROV_HRCHY where PG_ID NOT LIKE 'OA%' AND  CURRENT_DATE BETWEEN HRCHY_EFCTV_DT AND HRCHY_TRMNTN_DT and RCRD_STTS_CD = 'ACT'"
query_pgm_pg="select * FROM <spcp-splice-db>.PGM_PG where CURRENT_DATE BETWEEN PGM_PG_EFCTV_DT AND PGM_PG_TRMNTN_DT AND RCRD_STTS_CD = 'ACT'"
query_pi_pgm="select * FROM <spcp-splice-db>.PI_PGM where PGM_TYPE_CD in('8000','8001','8004','8005','8008','8009','8011','8012','8021','8022','8023','8024') AND CURRENT_DATE BETWEEN PGM_EFCTV_DT AND PGM_TRMNTN_DT AND RCRD_STTS_CD = 'ACT'"
query_pi_pgm_lob="select * FROM <spcp-splice-db>.PI_PGM_LOB where CURRENT_DATE BETWEEN PGM_LOB_EFCTV_DT AND PGM_LOB_TRMNTN_DT AND LOB_ID = 'Commercial'   AND RCRD_STTS_CD = 'ACT'"
query_pgm_lob_psl="select * FROM <spcp-splice-db>.PGM_LOB_PSL where CURRENT_DATE BETWEEN PGM_LOB_PSL_EFCTV_DT AND PGM_LOB_PSL_TRMNTN_DT AND RCRD_STTS_CD = 'ACT'"
query_pgm_lob_psl_parm="select * FROM <spcp-splice-db>.PGM_LOB_PSL_PARM where RPTG_ONLY_IND = '2' AND CURRENT_DATE BETWEEN PSL_PARM_EFCTV_DT AND PSL_PARM_TRMNTN_DT"

#PRODUCT TABLE QUERIES
query_prod_pkg="select trim(PROD.SRC_PROD_TYPE_CD) as SRC_PROD_TYPE_CD , trim(BNFT_PKG.BNFT_PKG_ID) as BNFT_PKG_ID,trim(BNFT_PKG.BNFT_PKG_KEY) as BNFT_PKG_KEY,trim(BNFT_PKG.PROD_SOR_CD) as PROD_SOR_CD,trim(PROD.HLTH_PROD_SRVC_TYPE_CD) as HLTH_PROD_SRVC_TYPE_CD,trim(PROD.PROD_ID) as PROD_ID From <cdl-edwd-db>.BNFT_PKG BNFT_PKG,<cdl-edwd-db>.PROD PROD WHERE BNFT_PKG.PROD_SOR_CD = PROD.PROD_SOR_CD AND BNFT_PKG.PROD_ID = PROD.PROD_ID AND BNFT_PKG.PROD_SOR_CD IN ('812','813','814')"
query_prod_plan="SELECT  trim(T3.PLAN_ID) as PLAN_ID,trim(T3.PROD_FMLY_TYPE_CD) as PROD_FMLY_TYPE_CD ,T3.PLAN_EFCTV_DT,T3.PLAN_TRMNTN_DT,T3.BNFT_PKG_ADDNL_EFCTV_DT,trim(T4.BNFT_PKG_KEY) as BNFT_PKG_KEY,trim(T4.BNFT_PKG_ID) as BNFT_PKG_ID,trim(T4.PROD_SOR_CD) as PROD_SOR_CD ,TRIM(T3.PLAN_ST_CD) AS PLAN_ST_CD FROM (SELECT T1.PLAN_ST_CD,T1.PLAN_ID,T1.PROD_FMLY_TYPE_CD,T1.PLAN_EFCTV_DT,T1.PLAN_TRMNTN_DT,T2.BNFT_PKG_ADDNL_EFCTV_DT,T2.BNFT_PKG_KEY FROM (SELECT * FROM (SELECT trim(A.PLAN_ID) as PLAN_ID, A.SOR_DTM, trim(A.PROD_FMLY_TYPE_CD) as PROD_FMLY_TYPE_CD, A.PLAN_EFCTV_DT, trim(A.PLAN_ST_CD) as PLAN_ST_CD, A.PLAN_TRMNTN_DT,ROW_NUMBER() OVER (PARTITION BY A.PLAN_ID ORDER BY A.SOR_DTM DESC) "RNUM1" FROM (SELECT * FROM <cdl-edwd-db>.PLAN  WHERE PROD_SOR_CD='1000') A ) B WHERE B.RNUM1 = 1) T1 INNER JOIN(SELECT * FROM (SELECT trim(C.BNFT_PKG_KEY) as BNFT_PKG_KEY, trim(C.PLAN_ID) as PLAN_ID, C.SOR_DTM, C.BNFT_PKG_ADDNL_EFCTV_DT, ROW_NUMBER() OVER (PARTITION BY C.BNFT_PKG_KEY, C.PLAN_ID ORDER BY C.SOR_DTM DESC) "RNUM2" FROM (SELECT * FROM <cdl-edwd-db>.CNTRCT_PLAN WHERE PROD_SOR_CD='1000') C) D WHERE D.RNUM2 = 1) T2 ON T1.PLAN_ID = T2.PLAN_ID) T3 INNER JOIN(SELECT trim(BNFT_PKG_KEY) as BNFT_PKG_KEY, trim(BNFT_PKG_ID) as BNFT_PKG_ID, trim(PROD_SOR_CD) as PROD_SOR_CD FROM <cdl-edwd-db>.BNFT_PKG WHERE PROD_SOR_CD='1000') T4 ON T3.BNFT_PKG_KEY = T4.BNFT_PKG_KEY"